djangorestframework-simplejwt: jwt認証用フレームワーク
django-otp : 2FA認証
qrcode : QRコード

jwt
ヘッダ: JWTの種類（アルゴリズム:alg）と署名方式（type）を指定
'''
{
  "alg": "HS256",
  "typ": "JWT"
}
'''

ペイロード：ユーザー情報やトークンの有効期限を含むデータ
'''
{
  "sub": "1234567890",   // ユーザーID
  "name": "John Doe",
  "iat": 1610000000,     // トークン発行日時
  "exp": 1610003600      // トークン有効期限（1時間後）
}
'''

署名：データが改ざんされていないか検証するためのデジタル署名
秘密鍵や公開鍵を使用して署名を作成
例（HS256を使用）
'''
HMACSHA256(
  base64urlEncode(ヘッダー) + "." + base64urlEncode(ペイロード),
  秘密鍵
)
'''
この署名があることでトークンの信頼性を保証。


仕組み
/login や/signupエンドポイントでユーザーがログインし、認証が成功するとJWTトークンを発行。クライアントは、このJWTトークンをAuthorization: Bearer <JWT>　ヘッダーに含めて送信

クライアントはAPIリクエスト時にJWTをHTTPリクエストのヘッダーに含め、サーバーがそれを検証することで認証に成功したらデータを返す。

JWTの有効期限が切れたら、リフレッシュトークンを用いて再発行する。
→ログイン時にアクセストークンとリフレッシュトークンを発行
アクセストークンが切れたらリフレッシュトークンを用いて新しいアクセストークンを発行。
リフレッシュトークンの有効期限が切れたら再ログインが必要

メリット
・セッション不要
・シンプルな構造
・署名付きで改ざん防止が可能
・フロントとバックの分離が簡単

デメリット
・サイズが大きい
・トークンの執行が難しい
・セキュリティリスク


流れ
1. ユーザーがログイン
2. サーバーが認証情報を検証
3. 2FAコード（OTP等）を要求
4. ユーザーが正しい2FAコードを入力
5. 認証成功→JWTにトークンを発行
6. クライアントはJWTを用いてAPIにアクセス